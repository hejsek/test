<div id="moon"><div class="shadow"></div></div>
<div id="particles-js"></div>
<div id="fireflies-js"></div>
<div id="story-container" class="container text-center mt-5">
  <h1 class="mb-4">Bedtime Story Reader</h1>
  <div class="input-group justify-content-center mb-3">
    <input
      type="text"
      class="form-control w-auto"
      [(ngModel)]="prompt"
      placeholder="Enter theme for your bedtime story"
    />
    <button class="btn btn-primary" (click)="generate()" [disabled]="loading">
      <span
        *ngIf="loading"
        class="spinner-border spinner-border-sm me-2"
        role="status"
      ></span>
      Generate
    </button>
  </div>

  <div *ngIf="displayedStory" class="text-display animated-story">{{ displayedStory }}</div>
  <button *ngIf="story" class="btn btn-secondary mt-3" (click)="playStory()" [disabled]="loading">Play Audio</button>

  <div *ngIf="audioUrl" class="mt-4">
    <div class="audio-container">
      <audio
        #player
        id="audio-player"
        controls
        [src]="audioUrl"
        class="w-100"
        (timeupdate)="onTimeUpdate()"
        (ended)="onEnded()"
      ></audio>
    </div>
    <div class="text-display">
      <span
        *ngFor="let word of words; let i = index"
        [class.highlight]="i === currentWordIndex"
      >{{ word }} </span
      >
    </div>
  </div>
  <button class="btn btn-info mt-3" data-bs-toggle="modal" data-bs-target="#cloneModal">Clone</button>
</div>

<!-- Clone Modal -->
<div class="modal fade" id="cloneModal" tabindex="-1" aria-labelledby="cloneModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="cloneModalLabel">Clone</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
      </div>
    </div>
  </div>
</div>
